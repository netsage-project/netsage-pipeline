<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.72">
<link rel="alternate" type="application/rss+xml" href="/netsage-pipeline/blog/rss.xml" title="Netsage Pipeline Documentation Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/netsage-pipeline/blog/atom.xml" title="Netsage Pipeline Documentation Blog Atom Feed"><title data-react-helmet="true">Pipeline Logstash | Netsage Pipeline Documentation</title><meta data-react-helmet="true" property="og:url" content="https://netsage-project.github.io/netsage-pipeline/docs/1.2.6/pipeline_logstash"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="1.2.6"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-1.2.6"><meta data-react-helmet="true" property="og:title" content="Pipeline Logstash | Netsage Pipeline Documentation"><meta data-react-helmet="true" name="description" content="Logstash"><meta data-react-helmet="true" property="og:description" content="Logstash"><link data-react-helmet="true" rel="shortcut icon" href="/netsage-pipeline/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://netsage-project.github.io/netsage-pipeline/docs/1.2.6/pipeline_logstash"><link data-react-helmet="true" rel="alternate" href="https://netsage-project.github.io/netsage-pipeline/docs/1.2.6/pipeline_logstash" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://netsage-project.github.io/netsage-pipeline/docs/1.2.6/pipeline_logstash" hreflang="x-default"><link rel="stylesheet" href="/netsage-pipeline/assets/css/styles.c0b86565.css">
<link rel="preload" href="/netsage-pipeline/assets/js/styles.a65f062a.js" as="script">
<link rel="preload" href="/netsage-pipeline/assets/js/runtime~main.e2434378.js" as="script">
<link rel="preload" href="/netsage-pipeline/assets/js/main.ca2bf310.js" as="script">
<link rel="preload" href="/netsage-pipeline/assets/js/1.d7dedcfb.js" as="script">
<link rel="preload" href="/netsage-pipeline/assets/js/2.1fde247e.js" as="script">
<link rel="preload" href="/netsage-pipeline/assets/js/141.d17f1db5.js" as="script">
<link rel="preload" href="/netsage-pipeline/assets/js/142.d881c78f.js" as="script">
<link rel="preload" href="/netsage-pipeline/assets/js/7d380c4c.b3d49c6d.js" as="script">
<link rel="preload" href="/netsage-pipeline/assets/js/17896441.8da1b243.js" as="script">
<link rel="preload" href="/netsage-pipeline/assets/js/38d1fe39.8f457070.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/netsage-pipeline/"><img src="/netsage-pipeline/img/logo.png" alt="NetSage Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/netsage-pipeline/img/logo.png" alt="NetSage Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">NetSage Documentation</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/netsage-pipeline/docs/pipeline/intro">Pipeline Documentation</a><a href="https://netsage-project.github.io/netsage-grafana-configs/" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">Dashboard Documentation</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link" href="/netsage-pipeline/docs/1.2.6/pipeline">1.2.6</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/netsage-pipeline/docs/next/pipeline/intro">master (unreleased)</a></li><li><a class="dropdown__link" href="/netsage-pipeline/docs/pipeline/intro">1.2.11</a></li><li><a class="dropdown__link" href="/netsage-pipeline/docs/1.2.10/pipeline/intro">1.2.10</a></li><li><a class="dropdown__link" href="/netsage-pipeline/docs/1.2.9/pipeline/intro">1.2.9</a></li><li><a class="dropdown__link" href="/netsage-pipeline/docs/1.2.8/pipeline/intro">1.2.8</a></li><li><a class="dropdown__link" href="/netsage-pipeline/docs/1.2.7/pipeline/intro">1.2.7</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/netsage-pipeline/docs/1.2.6/pipeline_logstash">1.2.6</a></li><li><a class="dropdown__link" href="/netsage-pipeline/docs/1.2.5/pipeline_logstash">1.2.5</a></li></ul></div><a href="https://github.com/netsage-project/netsage-pipeline/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_GrZ2"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/netsage-pipeline/"><img src="/netsage-pipeline/img/logo.png" alt="NetSage Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/netsage-pipeline/img/logo.png" alt="NetSage Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">NetSage Documentation</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/netsage-pipeline/docs/pipeline/intro">Pipeline Documentation</a></li><li class="menu__list-item"><a href="https://netsage-project.github.io/netsage-grafana-configs/" target="_self" rel="noopener noreferrer" class="menu__link">Dashboard Documentation</a></li><li class="menu__list-item"><a role="button" class="menu__link menu__link--sublist">Versions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/netsage-pipeline/docs/next/pipeline/intro">master (unreleased)</a></li><li class="menu__list-item"><a class="menu__link" href="/netsage-pipeline/docs/pipeline/intro">1.2.11</a></li><li class="menu__list-item"><a class="menu__link" href="/netsage-pipeline/docs/1.2.10/pipeline/intro">1.2.10</a></li><li class="menu__list-item"><a class="menu__link" href="/netsage-pipeline/docs/1.2.9/pipeline/intro">1.2.9</a></li><li class="menu__list-item"><a class="menu__link" href="/netsage-pipeline/docs/1.2.8/pipeline/intro">1.2.8</a></li><li class="menu__list-item"><a class="menu__link" href="/netsage-pipeline/docs/1.2.7/pipeline/intro">1.2.7</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/netsage-pipeline/docs/1.2.6/pipeline_logstash">1.2.6</a></li><li class="menu__list-item"><a class="menu__link" href="/netsage-pipeline/docs/1.2.5/pipeline_logstash">1.2.5</a></li></ul></li><li class="menu__list-item"><a href="https://github.com/netsage-project/netsage-pipeline/" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper main-docs-wrapper"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Pipeline</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/netsage-pipeline/docs/1.2.6/pipeline">Intro</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/netsage-pipeline/docs/1.2.6/pipeline_importer">Importer</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/netsage-pipeline/docs/1.2.6/pipeline_logstash">Logstash</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Developer Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/netsage-pipeline/docs/1.2.6/devel/docker">Docker Guide</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Deployment Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/netsage-pipeline/docs/1.2.6/deploy/choose_install">Choose Install</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/netsage-pipeline/docs/1.2.6/deploy/install">Installation Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/netsage-pipeline/docs/1.2.6/deploy/docker_install">Docker Install</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Documentation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/netsage-pipeline/docs/1.2.6/docusaurus">Documentation Guide</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for Netsage Pipeline Documentation <strong>1.2.6</strong>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <strong><a href="/netsage-pipeline/docs/pipeline/intro">latest version</a></strong> (1.2.11).</div></div><div class="docItemContainer_33ec"><article><div><span class="badge badge--secondary">Version: 1.2.6</span></div><header><h1 class="docTitle_3a4h">Pipeline Logstash</h1></header><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="logstash"></a>Logstash<a class="hash-link" href="#logstash" title="Direct link to heading">#</a></h1><p>These Logstash config files are in /etc/logstash/conf.d/</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="logstash-sequence"></a>Logstash Sequence<a class="hash-link" href="#logstash-sequence" title="Direct link to heading">#</a></h2><p>The following steps are defined for logstash:</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="01-input-rabbitconf"></a>01-input-rabbit.conf<a class="hash-link" href="#01-input-rabbitconf" title="Direct link to heading">#</a></h3><p>Reads flows from a rabbitmq queue. (&quot;.disabled&quot; can be removed from other input configs to get flows from other sources.)</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="10-preliminariesconf"></a>10-preliminaries.conf<a class="hash-link" href="#10-preliminariesconf" title="Direct link to heading">#</a></h3><p>Drops flows to or from private IP addresses;
adds @ingest_time (this is mainly for developers);
converts any timestamps in milliseconds to seconds;
drops events with timestamps more than a year in the past or (10 sec) in the future;
does some data type conversions</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="20-add_idconf"></a>20-add_id.conf<a class="hash-link" href="#20-add_idconf" title="Direct link to heading">#</a></h3><p>Adds a unique id based on the 5-tuple of the flow (src and dst ips and ports, and protocol) plus the sensor name. This ends up being called meta.id.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="40-aggregationconf"></a>40-aggregation.conf<a class="hash-link" href="#40-aggregationconf" title="Direct link to heading">#</a></h3><p>Stitches together flows from different nfcapd files into longer flows, matching them up by meta.id and using a specified inactivity_timeout to decide when to start a new flow.</p><p>Notes: By default, 5-minute nfcapd files are assumed, and if less than 10.5 min have passed between the start of the current flow and the start of the last matching one, stitch the two together.</p><p>Your logstash pipeline can have only 1 worker or aggregation is not going to work! </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="45-geoip-taggingconf"></a>45-geoip-tagging.conf<a class="hash-link" href="#45-geoip-taggingconf" title="Direct link to heading">#</a></h3><p>If the destination IP is in the multicast range, sets the destination Organization, Country, and Continent to &quot;Multicast&quot;;
queries the MaxMind GeoLite2-City database by IP to get src and dst Countries, Continents, Latitudes, and Longitudes. </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="50-asnconf"></a>50-asn.conf<a class="hash-link" href="#50-asnconf" title="Direct link to heading">#</a></h3><p>Normally, flows come in with source and destination ASNs.  If there is no ASN in the input event; or the input ASN is 0, 4294967295, or 23456, or it is a private ASN, try getting an ASN by IP from the MaxMind ASN database.
Sets ASN to -1 if it is unavailable for any reason.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="53-caida-orgconf"></a>53-caida-org.conf<a class="hash-link" href="#53-caida-orgconf" title="Direct link to heading">#</a></h3><p>Uses the ASN determined previously to get the organization name from the prepared CAIDA lookup file.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="55-member-orgsconf"></a>55-member-orgs.conf<a class="hash-link" href="#55-member-orgsconf" title="Direct link to heading">#</a></h3><p>Search (optional) lookup tables by IP to obtain member or customer organization names and overwrite the Organization determined previously.
This allows entities which don&#x27;t own their own ASs to be listed as the src or dst Organization.</p><p>Notes: These lookup tables are not stored in github.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="60-scireg-tagging-fakegeoipconf"></a>60-scireg-tagging-fakegeoip.conf<a class="hash-link" href="#60-scireg-tagging-fakegeoipconf" title="Direct link to heading">#</a></h3><p>Uses a fake geoip database containing Science Registry information to tag the flows with source and destination science disciplines and roles, organizations and locations, etc;
removes scireg fields we don&#x27;t need to save to elasticsearch.</p><p>Notes: The science registry fake geoip database can be downloaded from scienceregistry.grnoc.iu.edu via wget in a cron job. </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="70-deidentifyconf"></a>70-deidentify.conf<a class="hash-link" href="#70-deidentifyconf" title="Direct link to heading">#</a></h3><p>Replaces the last octet of IPv4 addresses and the last 4 hextets of IPv6 addresses with x&#x27;s in order to deidentify them. </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="80-privatizeorgconf"></a>80-privatize.org.conf<a class="hash-link" href="#80-privatizeorgconf" title="Direct link to heading">#</a></h3><p>Removes information about Australian organizations (or, with modification, any country that has privacy rules that require us not to identify organizations).
If the ASN is one of those listed, completely replaces the IP with x&#x27;s, sets the location to central Autralia, sets all organizations to &quot;AARNet&quot;, removes all Projects.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="88-preferred-location-orgconf"></a>88-preferred-location-org.conf<a class="hash-link" href="#88-preferred-location-orgconf" title="Direct link to heading">#</a></h3><p>Copies Science Registry organization and location values, if they exist, to the preferred_organization and preferred_location fields.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="90-additional-fieldsconf"></a>90-additional-fields.conf<a class="hash-link" href="#90-additional-fieldsconf" title="Direct link to heading">#</a></h3><p>Sets additional quick and easy fields.  Currently we have:
<em>sensor_group  = TACC, AMPATH, etc.  (based on matching sensor names to regexes)
</em>sensor_type    = Circuit, Archive, Exchange Point, or Regional Network  (based on matching sensor names to regexes)
<em>country_scope = Domestic, International, or Mixed  (based on src and dst countries, where Domestic = US, Puerto Rico, or Guam)
</em>is_network_testing = yes, no  (yes if discipline = CS.Network Testing and Monitoring or port = 5001, 5101, or 5201)</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="95-cleanupconf"></a>95-cleanup.conf<a class="hash-link" href="#95-cleanupconf" title="Direct link to heading">#</a></h3><p>Does small misc. tasks at the end like rename, remove, or convert fields</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="98-post-processconf"></a>98-post-process.conf<a class="hash-link" href="#98-post-processconf" title="Direct link to heading">#</a></h3><p>Adds @exit_time and @processing_time (these are mainly for developers)</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="99-output-rabbitconf"></a>99-output-rabbit.conf<a class="hash-link" href="#99-output-rabbitconf" title="Direct link to heading">#</a></h3><p>Sends results to a rabbitmq queue (&quot;.disabled&quot; can be removed from other output configs to send flows to other places)</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="final-stage"></a>Final Stage<a class="hash-link" href="#final-stage" title="Direct link to heading">#</a></h3><p>In our case, OmniSOC manages the last stage. Their logstash instance reads flows from the netsage_archive_input queue and sends it into elasticsearch. The indices are named like om-ns-netsage-YYYY.mm.dd-<em> (or om-ns-ilight-</em>, etc).  </p><p>This can be easily replicated with the following configuration though you&#x27;ll need one for each feed/index.</p><p>Naturally the hosts for rabbit and elastic will need to be updated accordingly.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">input {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  rabbitmq {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    host =&gt; &#x27;localhost&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    user =&gt; &#x27;guest&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    password =&gt; &quot;${rabbitmq_pass}&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exchange =&gt; &#x27;netsage.direct&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    key =&gt;   XXXXXXX&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    queue =&gt; &#x27;netsage&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    durable =&gt; true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    subscription_retry_interval_seconds =&gt; 5</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    connection_timeout =&gt; 10000</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">filter {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  if [@metadata][rabbitmq_properties][timestamp] {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    date {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      match =&gt; [&quot;[@metadata][rabbitmq_properties][timestamp]&quot;, &quot;UNIX&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">output {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    elasticsearch {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      hosts =&gt; [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;https://CHANGEME1&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;https://CHANGEME2&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      user =&gt; &quot;logstash&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      password =&gt; &quot;${logstash_elasticsearch_password}&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      cacert =&gt; &quot;/etc/logstash/ca.crt&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      index =&gt; &quot;om-ns-netsage&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      template_overwrite =&gt; true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      failure_type_logging_whitelist =&gt; []</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      action =&gt; index</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      #ssl_certificate_verification =&gt; false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Once the data is published in elastic, you can use the <a href="https://github.com/netsage-project/netsage-grafana-configs" target="_blank" rel="noopener noreferrer">grafana dashboard</a> to visualize the data.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="elasticsearch-fields"></a>Elasticsearch Fields<a class="hash-link" href="#elasticsearch-fields" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="es-fields"></a>ES fields<a class="hash-link" href="#es-fields" title="Direct link to heading">#</a></h3><table><thead><tr><th>name</th><th>example</th><th>description</th></tr></thead><tbody><tr><td>_index</td><td>om-ns-netsage-2020.06.</td><td>equivalent to an sql table</td></tr><tr><td>_type</td><td>_doc</td><td>set by ES</td></tr><tr><td>_id</td><td>HRkcm3IByJ9fEnbnCpaY</td><td>document id, set by ES</td></tr><tr><td>_score</td><td>1</td><td>set by ES query</td></tr><tr><td>@version</td><td>1</td><td>set by ES</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="developer-fields"></a>Developer fields<a class="hash-link" href="#developer-fields" title="Direct link to heading">#</a></h3><table><thead><tr><th>name</th><th>example</th><th>description</th></tr></thead><tbody><tr><td>type</td><td>flow</td><td>Always &quot;flow&quot; for us. Other types may be &quot;macy&quot;, etc.</td></tr><tr><td>@injest_time</td><td>2020-06-09T21:51:57.059Z</td><td>Essentially time the flow went into the logstash pipeline (10-preliminaries.conf for tstat flows) or the time stitching of the flow commenced (40-aggregation.conf for others)</td></tr><tr><td>@timestamp</td><td>Jun 9, 2020 @ 18:03:21.703</td><td>The time the flow went into the logstash pipeline for tstat flows, or the time stitching finished and the event was pushed for other flows.</td></tr><tr><td>@exit_time</td><td>Jun 9, 2020 @ 18:03:25.369</td><td>The time the flow exited the pipeline (99-outputs.conf)</td></tr><tr><td>@processing_time</td><td>688.31</td><td>@exit_time minus @injest_time. Useful for seeing how long stitching took.</td></tr><tr><td>stitched_flows</td><td>1</td><td>Number of flows stitched together to make this final one. 0 for tstat flows, which are always complete. 1 if no flows were stitched together.</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="flow-fields"></a>Flow fields<a class="hash-link" href="#flow-fields" title="Direct link to heading">#</a></h3><table><thead><tr><th>name</th><th>example</th><th>description</th></tr></thead><tbody><tr><td>start</td><td>Jun 9, 2020 @ 17:39:53.808</td><td>Start time of the flow (first packet seen)</td></tr><tr><td>end</td><td>Jun 9, 2020 @ 17:39:57.699</td><td>End time of the flow   (last packet seen)</td></tr><tr><td>meta.protocol</td><td>tcp</td><td>Protocol used</td></tr><tr><td>meta.id</td><td>a17c4f05420d7ded9eb151ccd293a633 ff226d1752b24e0f4139a87a8b26d779</td><td>Assigned flow id</td></tr><tr><td>meta.flow_type</td><td>sflow</td><td>Sflow, Netflow, or Tstat</td></tr><tr><td>meta.sensor_id</td><td>snvl2-pw-sw-1-mgmt-2.cenic.net</td><td>Sensor name (set in importer config, may not always be a hostname)</td></tr><tr><td>meta.sensor_group</td><td>CENIC</td><td>Assigned sensor group</td></tr><tr><td>meta.sensor_type</td><td>Regional Network</td><td>Assigned sensor type</td></tr><tr><td>meta.country_scope</td><td>Domestic</td><td>Domestic, International, or Mixed, depending on countries of src and dst</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="source-fields-destination-fields-similarly"></a>Source Fields (Destination Fields similarly)<a class="hash-link" href="#source-fields-destination-fields-similarly" title="Direct link to heading">#</a></h3><table><thead><tr><th>name</th><th>example</th><th>description</th></tr></thead><tbody><tr><td>meta.src_ip</td><td>171.64.68.x</td><td>deidentified IP address</td></tr><tr><td>meta.src_port</td><td>80</td><td>port used</td></tr><tr><td>meta.src_asn</td><td>32</td><td>ASN of the IP from geoip ASN database or the ASN from the flow header</td></tr><tr><td>meta.src_location.lat</td><td>37.423</td><td>latitude of IP from geoip database</td></tr><tr><td>meta.src_location.lon</td><td>-122.164</td><td>longitude of IP from geoip database</td></tr><tr><td>meta.src_country_name</td><td>United States</td><td>country of IP from geoip database</td></tr><tr><td>meta.src_continent</td><td>North America</td><td>continent of IP from geoip database</td></tr><tr><td>meta.src_organization</td><td>Stanford University</td><td>organization that owns the AS of the IP from geoip ASN database</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="source-science-registry-fields--destination-fields-similarly"></a>Source Science Registry Fields  (Destination Fields similarly)<a class="hash-link" href="#source-science-registry-fields--destination-fields-similarly" title="Direct link to heading">#</a></h3><table><thead><tr><th>name</th><th>example</th><th>description</th></tr></thead><tbody><tr><td>meta.scireg.src.resource</td><td>Stanford - ImageNet</td><td>Resource name from SciReg</td></tr><tr><td>meta.scireg.src.resource_abbr</td><td>-</td><td>Resource abbreviation (if any)</td></tr><tr><td>meta.scireg.src.discipline</td><td>CS. Intelligent Systems</td><td>The science discipline that uses the resource (ie host). Note that  not the src MAY not have the same discipline as the dst.</td></tr><tr><td>meta.scireg.src.role</td><td>Storage</td><td>Role that the host plays</td></tr><tr><td>meta.scireg.src.org_name</td><td>Stanford University</td><td>The organization the manages and/or uses the resource, as listed in the Science Registry</td></tr><tr><td>meta.scireg.src.org_abbr</td><td>Stanford</td><td>A shorter name for the organization. May not be the official abbreviation.</td></tr><tr><td>meta.scireg.src.projects</td><td>.</td><td>Can be an array of projects [we may change this field name soon]</td></tr><tr><td>meta.scireg.src.latitude</td><td>37.4178</td><td>Resource&#x27;s location, as listed in the Science Registry</td></tr><tr><td>meta.scireg.src.longitude</td><td>-122.172</td><td></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="preferred-fields"></a>&quot;Preferred&quot; fields<a class="hash-link" href="#preferred-fields" title="Direct link to heading">#</a></h3><table><thead><tr><th>name</th><th>example</th><th>description</th></tr></thead><tbody><tr><td>meta.src_preferred_org</td><td>Stanford University</td><td>If the IP was found in the Science Registry, these are the SciReg values.</td></tr><tr><td>meta.src_preferred_location.lat</td><td>37.417800</td><td>Otherwise, they are the geoip values.</td></tr><tr><td>meta.src_preferred_location.lon</td><td>-122.172000</td><td></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="values"></a>Values<a class="hash-link" href="#values" title="Direct link to heading">#</a></h3><table><thead><tr><th>name</th><th>example</th><th>description</th></tr></thead><tbody><tr><td>values.num_bits</td><td>939, 458, 560</td><td>Sum of the number of bits in all the stitched flows</td></tr><tr><td>values.num_packets</td><td>77, 824</td><td>Sum of the number of packets in all the stitched flows</td></tr><tr><td>values.duration</td><td>3.891</td><td>Calculated as end minus start</td></tr><tr><td>values.bits_per_second</td><td>241, 443, 988</td><td>Calculated as num_bits divided by duration</td></tr><tr><td>values.packets_per_second</td><td>20, 001</td><td>Calculated as num_packets divided by duration</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="tstat-values"></a>Tstat Values<a class="hash-link" href="#tstat-values" title="Direct link to heading">#</a></h3><table><thead><tr><th>name</th><th>example</th></tr></thead><tbody><tr><td>values.tcp_cwin_max</td><td>1549681</td></tr><tr><td>values.tcp_cwin_min</td><td>17</td></tr><tr><td>values.tcp_initial_cwin</td><td>313</td></tr><tr><td>values.tcp_max_seg_size</td><td>64313</td></tr><tr><td>values.tcp_min_seg_size</td><td>17</td></tr><tr><td>values.tcp_mss</td><td>8960</td></tr><tr><td>values.tcp_out_seq_pkts</td><td>0</td></tr><tr><td>values.tcp_pkts_dup</td><td>0</td></tr><tr><td>values.tcp_pkts_fc</td><td>0</td></tr><tr><td>values.tcp_pkts_fs</td><td>0</td></tr><tr><td>values.tcp_pkts_reor</td><td>0</td></tr><tr><td>values.tcp_pkts_rto</td><td>0</td></tr><tr><td>values.tcp_pkts_unfs</td><td>0</td></tr><tr><td>values.tcp_pkts_unk</td><td>2</td></tr><tr><td>values.tcp_pkts_unrto</td><td>0</td></tr><tr><td>values.tcp_rexmit_bytes</td><td>1678</td></tr><tr><td>values.tcp_rexmit_pkts</td><td>2</td></tr><tr><td>values.tcp_rtt_avg</td><td>0.044</td></tr><tr><td>values.tcp_rtt_max</td><td>39.527</td></tr><tr><td>values.tcp_rtt_min</td><td>0.001</td></tr><tr><td>values.tcp_rtt_std</td><td>0.276</td></tr><tr><td>values.tcp_sack_cnt</td><td>1</td></tr><tr><td>values.tcp_win_max</td><td>1549681</td></tr><tr><td>values.tcp_win_min</td><td>17</td></tr><tr><td>values.tcp_window_scale</td><td>13</td></tr></tbody></table></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/netsage-project/netsage-pipeline/edit/master/website/versioned_docs/version-1.2.6/pipeline_logstash.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/netsage-pipeline/docs/1.2.6/pipeline_importer"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Importer</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/netsage-pipeline/docs/1.2.6/devel/docker"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Docker Guide Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#logstash-sequence" class="table-of-contents__link">Logstash Sequence</a><ul><li><a href="#01-input-rabbitconf" class="table-of-contents__link">01-input-rabbit.conf</a></li><li><a href="#10-preliminariesconf" class="table-of-contents__link">10-preliminaries.conf</a></li><li><a href="#20-add_idconf" class="table-of-contents__link">20-add_id.conf</a></li><li><a href="#40-aggregationconf" class="table-of-contents__link">40-aggregation.conf</a></li><li><a href="#45-geoip-taggingconf" class="table-of-contents__link">45-geoip-tagging.conf</a></li><li><a href="#50-asnconf" class="table-of-contents__link">50-asn.conf</a></li><li><a href="#53-caida-orgconf" class="table-of-contents__link">53-caida-org.conf</a></li><li><a href="#55-member-orgsconf" class="table-of-contents__link">55-member-orgs.conf</a></li><li><a href="#60-scireg-tagging-fakegeoipconf" class="table-of-contents__link">60-scireg-tagging-fakegeoip.conf</a></li><li><a href="#70-deidentifyconf" class="table-of-contents__link">70-deidentify.conf</a></li><li><a href="#80-privatizeorgconf" class="table-of-contents__link">80-privatize.org.conf</a></li><li><a href="#88-preferred-location-orgconf" class="table-of-contents__link">88-preferred-location-org.conf</a></li><li><a href="#90-additional-fieldsconf" class="table-of-contents__link">90-additional-fields.conf</a></li><li><a href="#95-cleanupconf" class="table-of-contents__link">95-cleanup.conf</a></li><li><a href="#98-post-processconf" class="table-of-contents__link">98-post-process.conf</a></li><li><a href="#99-output-rabbitconf" class="table-of-contents__link">99-output-rabbit.conf</a></li><li><a href="#final-stage" class="table-of-contents__link">Final Stage</a></li></ul></li><li><a href="#elasticsearch-fields" class="table-of-contents__link">Elasticsearch Fields</a><ul><li><a href="#es-fields" class="table-of-contents__link">ES fields</a></li><li><a href="#developer-fields" class="table-of-contents__link">Developer fields</a></li><li><a href="#flow-fields" class="table-of-contents__link">Flow fields</a></li><li><a href="#source-fields-destination-fields-similarly" class="table-of-contents__link">Source Fields (Destination Fields similarly)</a></li><li><a href="#source-science-registry-fields--destination-fields-similarly" class="table-of-contents__link">Source Science Registry Fields  (Destination Fields similarly)</a></li><li><a href="#preferred-fields" class="table-of-contents__link">&quot;Preferred&quot; fields</a></li><li><a href="#values" class="table-of-contents__link">Values</a></li><li><a href="#tstat-values" class="table-of-contents__link">Tstat Values</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 NetSage Built with Docusaurus.</div></div></div></footer></div>
<script src="/netsage-pipeline/assets/js/styles.a65f062a.js"></script>
<script src="/netsage-pipeline/assets/js/runtime~main.e2434378.js"></script>
<script src="/netsage-pipeline/assets/js/main.ca2bf310.js"></script>
<script src="/netsage-pipeline/assets/js/1.d7dedcfb.js"></script>
<script src="/netsage-pipeline/assets/js/2.1fde247e.js"></script>
<script src="/netsage-pipeline/assets/js/141.d17f1db5.js"></script>
<script src="/netsage-pipeline/assets/js/142.d881c78f.js"></script>
<script src="/netsage-pipeline/assets/js/7d380c4c.b3d49c6d.js"></script>
<script src="/netsage-pipeline/assets/js/17896441.8da1b243.js"></script>
<script src="/netsage-pipeline/assets/js/38d1fe39.8f457070.js"></script>
</body>
</html>