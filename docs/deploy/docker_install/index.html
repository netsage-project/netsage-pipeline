<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.66">
<title data-react-helmet="true">Docker Installation Guide | Netsage Pipeline Documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_language" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="1.2.6"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-1.2.6"><meta data-react-helmet="true" property="og:title" content="Docker Installation Guide | Netsage Pipeline Documentation"><meta data-react-helmet="true" name="description" content="The docker pattern is provided as much simpler and easier to use pattern that allows you to process and send data without having to deal with all"><meta data-react-helmet="true" property="og:description" content="The docker pattern is provided as much simpler and easier to use pattern that allows you to process and send data without having to deal with all"><meta data-react-helmet="true" property="og:url" content="https://netsage-project.github.io/netsage-pipeline/docs/deploy/docker_install"><link data-react-helmet="true" rel="shortcut icon" href="/netsage-pipeline/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://netsage-project.github.io/netsage-pipeline/docs/deploy/docker_install"><link rel="stylesheet" href="/netsage-pipeline/styles.bf9b0f11.css">
<link rel="preload" href="/netsage-pipeline/styles.30a89ff9.js" as="script">
<link rel="preload" href="/netsage-pipeline/runtime~main.5ea87a7f.js" as="script">
<link rel="preload" href="/netsage-pipeline/main.f582d45e.js" as="script">
<link rel="preload" href="/netsage-pipeline/1.e1463b01.js" as="script">
<link rel="preload" href="/netsage-pipeline/2.444a8fa2.js" as="script">
<link rel="preload" href="/netsage-pipeline/43.5653398d.js" as="script">
<link rel="preload" href="/netsage-pipeline/44.4b500b20.js" as="script">
<link rel="preload" href="/netsage-pipeline/7d380c4c.0daa1064.js" as="script">
<link rel="preload" href="/netsage-pipeline/17896441.3d630ac9.js" as="script">
<link rel="preload" href="/netsage-pipeline/9feaf8ab.ea00acf9.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/netsage-pipeline/"><img class="navbar__logo" src="/netsage-pipeline/img/logo.png" alt="NetSage Logo"><strong class="navbar__title">NetSage Documentation</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/netsage-pipeline/docs/pipeline">Pipeline Documentation</a><a href="https://netsage-project.github.io/netsage-grafana-configs/" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">Dashboard Documentation</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link" href="/netsage-pipeline/docs/pipeline">1.2.6</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/netsage-pipeline/docs/next/pipeline/intro">master (unreleased)</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/netsage-pipeline/docs/deploy/docker_install">1.2.6</a></li><li><a class="dropdown__link" href="/netsage-pipeline/docs/1.2.5/deploy/docker_install">1.2.5</a></li></ul></div><a href="https://github.com/netsage-project/netsage-pipeline/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/netsage-pipeline/"><img class="navbar__logo" src="/netsage-pipeline/img/logo.png" alt="NetSage Logo"><strong class="navbar__title">NetSage Documentation</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/netsage-pipeline/docs/pipeline">Pipeline Documentation</a></li><li class="menu__list-item"><a href="https://netsage-project.github.io/netsage-grafana-configs/" target="_self" rel="noopener noreferrer" class="menu__link">Dashboard Documentation</a></li><li class="menu__list-item"><a role="button" class="menu__link menu__link--sublist">Versions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/netsage-pipeline/docs/next/pipeline/intro">master (unreleased)</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/netsage-pipeline/docs/deploy/docker_install">1.2.6</a></li><li class="menu__list-item"><a class="menu__link" href="/netsage-pipeline/docs/1.2.5/deploy/docker_install">1.2.5</a></li></ul></li><li class="menu__list-item"><a href="https://github.com/netsage-project/netsage-pipeline/" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Pipeline</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/netsage-pipeline/docs/pipeline">Intro</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/netsage-pipeline/docs/pipeline_importer">Importer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/netsage-pipeline/docs/pipeline_logstash">Logstash</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Developer Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/netsage-pipeline/docs/devel/docker">Docker Guide</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Deployment Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/netsage-pipeline/docs/deploy/choose_install">Choose Install</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/netsage-pipeline/docs/deploy/install">Installation Guide</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/netsage-pipeline/docs/deploy/docker_install">Docker Install</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Documentation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/netsage-pipeline/docs/docusaurus">Documentation Guide</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><div><span class="badge badge--secondary">Version: 1.2.6</span></div><header><h1 class="docTitle_1Lrw">Docker Installation Guide</h1></header><div class="markdown"><p>The docker pattern is provided as much simpler and easier to use pattern that allows you to process and send data without having to deal with all
the nuances of getting the pipeline setup.</p><p>Before we start, you may have a read over the <a href="/netsage-pipeline/docs/devel/docker">developer docker guide</a> it contains several notes such as how to select the docker version and likely other bits of information you may find useful.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="nfdump"></a>Nfdump<a aria-hidden="true" tabindex="-1" class="hash-link" href="#nfdump" title="Direct link to heading">#</a></h2><p>Note that no matter if you use a localized version or take advantage of the docker container already built. You will need to configure your routers to send nfdump stats to the process collecting data on the host:port that you&#x27;ll be defining.</p><p>More info of nfdump can be found <a href="https://github.com/phaag/nfdump/" target="_blank" rel="noopener noreferrer">here</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="external-nfdump"></a>External Nfdump<a aria-hidden="true" tabindex="-1" class="hash-link" href="#external-nfdump" title="Direct link to heading">#</a></h3><p>In this case you have nfdump running in your network somewhere and would like to keep on using it rather then relying on the container provided.</p><p>You&#x27;ll need to update your scripts to output to \$PROJECT/data/input_data. Naturally all the paths are configurable but you&#x27;ll have a much easier if you stick to the defaults.</p><p>If you do choose to store the data elsewhere, the location may still need to be inside of the \$PROJECT or a docker volume location in order for docker to be able to reference it.</p><p>You will also need to configure your routers to point to the nfdump hostname and port in order for nfdump to collect data.</p><p>At this point please proceed to <a href="#common-pattern">Common Pattern</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="dockerized-nfdump"></a>Dockerized Nfdump<a aria-hidden="true" tabindex="-1" class="hash-link" href="#dockerized-nfdump" title="Direct link to heading">#</a></h3><p>After you&#x27;ve selected the version of docker you&#x27;ll be running. you can start the collector by simply running:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-sh codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker-compose up -d collector</span></div></div></div></div></div><p>The default version is 1.6.18. There are other versions released and :latest should be point to the latest one, but there is no particular effort made to make sure we released the latest version. You can get a listing of all the current tags listed <a href="https://hub.docker.com/r/netsage/nfdump-collector/tags" target="_blank" rel="noopener noreferrer">here</a> and the source to generate the docker image can be found <a href="https://github.com/netsage-project/docker-nfdump-collector" target="_blank" rel="noopener noreferrer">here</a> the code for the You may use a different version though there is no particular effort to have an image for every nfdump release.</p><p>By default the container comes up and will write data to <code>./data/input_data</code> and listen to udp traffic on localhost:9999.</p><p>continue to <a href="#common-pattern">Common Pattern</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="common-pattern"></a>Common Pattern<a aria-hidden="true" tabindex="-1" class="hash-link" href="#common-pattern" title="Direct link to heading">#</a></h2><p>Before continuing you need to choose if you are going to be use the &#x27;Develop&#x27; version which has the latest changes but might be a bit less stable or using the &#x27;Release&#x27; version.</p><ul><li><p>Development Version</p><ul><li>Disregard anything about <code>docker_select_version.sh</code> that will not apply to you </li><li>Update to latest code git pull origin master</li></ul></li><li><p>Release version</p><ul><li><code>git fetch; git checkout &lt;tag name&gt;</code> replace &quot;tag name&quot; with v1.2.5 or the version you intend to use.</li><li>Please select the version you wish to use using <code>./scripts/docker_select_version.sh</code>
it is HIGHLY recommended to not use the :latest as that is intended to be a developer release. You may still use it but be aware that you may have some instability each time you update.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="environment-file"></a>Environment file<a aria-hidden="true" tabindex="-1" class="hash-link" href="#environment-file" title="Direct link to heading">#</a></h3><p>Please make a copy of the .env and refer back to the docker <a href="/netsage-pipeline/docs/devel/docker">dev guide</a> on details on configuring the env. Most of the default value should work just fine.</p><p>The only major change you should be aware of are the following values. The output host defines where the final data will land. The sensorName defines what the data will be labeled as.</p><p>If you don&#x27;t send a sensor name it&#x27;ll use the default docker hostname which changes each time you run the pipeline.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-ini codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">rabbitmq_output_host=rabbit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">rabbitmq_output_username=guest</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">rabbitmq_output_pw=guest</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">rabbitmq_output_key=netsage_archive_input</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sflowSensorName=sflowSensorName</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">netflowSensorName=netflowSensorName</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><p>Please note, the default is to have one netflow collector and one sflow collector.  If you need more collectors or do no need netflow or sflow simply comment out the collector you wish to ignore.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="bringing-up-the-pipeline"></a>Bringing up the Pipeline<a aria-hidden="true" tabindex="-1" class="hash-link" href="#bringing-up-the-pipeline" title="Direct link to heading">#</a></h3><p>Starting up the pipeline using:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-sh codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker-compose up -d</span></div></div></div></div></div><p>You can check the logs for each of the container by running</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-sh codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker-compose logs</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="shutting-down-the-pipeline"></a>Shutting Down the pipeline.<a aria-hidden="true" tabindex="-1" class="hash-link" href="#shutting-down-the-pipeline" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-sh codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker-compose down</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="advanced-configuration"></a>Advanced Configuration<a aria-hidden="true" tabindex="-1" class="hash-link" href="#advanced-configuration" title="Direct link to heading">#</a></h3><p>The pipeline allows to have as many collectors as desired.  You should have a unique sensorName ENV variable for each type and a unique path where data is being delivered.</p><p>By convention everything is being written to ./data/input_data/sensorName You may change that behavior but just ensure the path between the colle</p><ol><li>Copy the compose/importer/netsage_shared.xml to userConfig/ and name it netsage_override.xml</li><li>In the docker-compose.yml uncomment the following line from the importer configuration.</li></ol><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-sh codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      - ./userConfig/netsage_override.xml:/etc/grnoc/netsage/deidentifier/netsage_shared.xml</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><p>This will use the <code>netsage_override.xml</code> in the userConfig instead of the container settings.</p><ol start="3"><li>Update collectors.</li></ol><p>You may add as many new collectors as you like just ensure the following is unique:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-yml codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">example-collector</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> netsage/nfdump</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">collector</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">1.6.18</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">command</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> nfcapd </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">T all </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">l /data </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">S 1 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">w </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">z </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">p 9999</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;9999:9999/udp&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">restart</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> always</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">volumes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> ./data/input_data/example</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">/data</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><ul><li><p>The command call should be updated.  nfcapd for netflow, sfcapd for sflow</p></li><li><p>The output under volumes needs to be unique. Replace /example with the appropriate value</p></li><li><p>Make sure to update the port.  The UDP port has to be unique.  Please update the command and port mapping.  </p><p>Technically you don&#x27;t need to change to port of the command, but make sure you use the correct pattern when mapping the new settings.</p></li></ul><p>Example: </p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-yml codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;9999:4321/udp&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><p>The first port is the port on your host, the second port is the port on your local machine. </p><ol start="4"><li>Update the netsage_override.xml and add a new entry for the collector you&#x27;re adding under the config section.</li></ol><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-xml codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">collection</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">flow-path</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">/data/input_data/example</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">flow-path</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">sensor</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">$exampleSensorName</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">sensor</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">flow-type</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">sflow</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">flow-type</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">collection</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><ol start="5"><li>Update the environment file.</li></ol><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-ini codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">exampleSensorName=example</span></div></div></div></div></div><ol start="6"><li>At this point, please update the router configuration to send data to the new port you&#x27;ve defined.  If the new collector is listening on 0.0.0.0:1234/udp then all traffic you wish grouped under </li></ol><p>the new sensor should be send to 1234/udp.  </p><p>You will need to repeat steps 3-6 for each collector you&#x27;re adding.  For each new configuration the path, sensorName and exposed port have to be unique.  Besides that, there is no limit
outside of the bounds of the host&#x27;s resources to how many collectors you may run.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="kibana-and-elastic-search"></a>Kibana and Elastic Search<a aria-hidden="true" tabindex="-1" class="hash-link" href="#kibana-and-elastic-search" title="Direct link to heading">#</a></h3><p>The file docker-compose.develop.yaml can be found in conjunction with docker-compose.yaml to bring up the optional Kibana and Elastic Search components.</p><p>This isn&#x27;t a production pattern but the tools can be useful at times. Please refer to the <a href="/netsage-pipeline/docs/devel/docker#optional-elasticsearch-and-kibana">Docker Dev Guide</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="troubleshooting"></a>Troubleshooting<a aria-hidden="true" tabindex="-1" class="hash-link" href="#troubleshooting" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="data-flow-issues"></a>Data Flow issues:<a aria-hidden="true" tabindex="-1" class="hash-link" href="#data-flow-issues" title="Direct link to heading">#</a></h3><p><strong>Troubleshooting checklist:</strong></p><ul><li>Make sure you configured your routers to point to the correct address/port where the collector is running.Â  hostname:9999 is the default.</li><li>Make sure you created a .env file and updated the settings accordingly.</li><li>sensorName especially since that identifies the source of the data.Â </li><li>check the logs of the various components to see if anything jumps out as being invalid.Â  docker-compose logs -f &lt;service_label&gt;</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="resource-limitations"></a>Resource Limitations<a aria-hidden="true" tabindex="-1" class="hash-link" href="#resource-limitations" title="Direct link to heading">#</a></h3><p>If you are running a lot of data sometimes docker may need to be allocated more memory.</p><p>Applying this snippet to logstash may help. Naturally the values will have to change.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-yaml codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">environment</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  + LS_JAVA_OPTS=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">Xmx3g</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><p>Alternatively you may also try doing this:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-yaml codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">deploy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">resources</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">limits</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cpus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;0.50&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 50M</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">reservations</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cpus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;0.25&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 20M</span></div></div></div></div></div><p>Reference: <a href="https://docs.docker.com/compose/compose-file/#resources" target="_blank" rel="noopener noreferrer">https://docs.docker.com/compose/compose-file/#resources</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="upgrading"></a>Upgrading<a aria-hidden="true" tabindex="-1" class="hash-link" href="#upgrading" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="update-source-code"></a>Update Source Code<a aria-hidden="true" tabindex="-1" class="hash-link" href="#update-source-code" title="Direct link to heading">#</a></h3><p>If your only changes are the version you selected simply reset and discard your changes.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">git reset --hard</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="development"></a>Development<a aria-hidden="true" tabindex="-1" class="hash-link" href="#development" title="Direct link to heading">#</a></h4><p>Update the git repo. Likely this won&#x27;t change anything but it&#x27;s always a good practice to have the latest version. You will need to do at least a git fetch in order to see the latest tags.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">git pull origin master</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="release"></a>Release<a aria-hidden="true" tabindex="-1" class="hash-link" href="#release" title="Direct link to heading">#</a></h4><ol><li>git checkout &lt;tag_value&gt; (ie. v1.2.6, v1.2.7 etc)</li><li><code>./scripts/docker_select_version.sh</code> select the same version as the tag you checked out.</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="update-docker-containers"></a>Update docker containers<a aria-hidden="true" tabindex="-1" class="hash-link" href="#update-docker-containers" title="Direct link to heading">#</a></h3><p>This applies for both development and release</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker-compose pull</span></div></div></div></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/netsage-project/netsage-pipeline/edit/master/website/versioned_docs/version-1.2.6/deploy/docker_install.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/netsage-pipeline/docs/deploy/install"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« NetSage Flow Processing Pipeline Install Guide</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/netsage-pipeline/docs/docusaurus"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Documentation Guide Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#nfdump" class="table-of-contents__link">Nfdump</a><ul><li><a href="#external-nfdump" class="table-of-contents__link">External Nfdump</a></li><li><a href="#dockerized-nfdump" class="table-of-contents__link">Dockerized Nfdump</a></li></ul></li><li><a href="#common-pattern" class="table-of-contents__link">Common Pattern</a><ul><li><a href="#environment-file" class="table-of-contents__link">Environment file</a></li><li><a href="#bringing-up-the-pipeline" class="table-of-contents__link">Bringing up the Pipeline</a></li><li><a href="#shutting-down-the-pipeline" class="table-of-contents__link">Shutting Down the pipeline.</a></li><li><a href="#advanced-configuration" class="table-of-contents__link">Advanced Configuration</a></li><li><a href="#kibana-and-elastic-search" class="table-of-contents__link">Kibana and Elastic Search</a></li></ul></li><li><a href="#troubleshooting" class="table-of-contents__link">Troubleshooting</a><ul><li><a href="#data-flow-issues" class="table-of-contents__link">Data Flow issues:</a></li><li><a href="#resource-limitations" class="table-of-contents__link">Resource Limitations</a></li></ul></li><li><a href="#upgrading" class="table-of-contents__link">Upgrading</a><ul><li><a href="#update-source-code" class="table-of-contents__link">Update Source Code</a></li><li><a href="#update-docker-containers" class="table-of-contents__link">Update docker containers</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="text--center"><div>Copyright Â© 2020 NetSage Built with Docusaurus.</div></div></div></footer></div>
<script src="/netsage-pipeline/styles.30a89ff9.js"></script>
<script src="/netsage-pipeline/runtime~main.5ea87a7f.js"></script>
<script src="/netsage-pipeline/main.f582d45e.js"></script>
<script src="/netsage-pipeline/1.e1463b01.js"></script>
<script src="/netsage-pipeline/2.444a8fa2.js"></script>
<script src="/netsage-pipeline/43.5653398d.js"></script>
<script src="/netsage-pipeline/44.4b500b20.js"></script>
<script src="/netsage-pipeline/7d380c4c.0daa1064.js"></script>
<script src="/netsage-pipeline/17896441.3d630ac9.js"></script>
<script src="/netsage-pipeline/9feaf8ab.ea00acf9.js"></script>
</body>
</html>