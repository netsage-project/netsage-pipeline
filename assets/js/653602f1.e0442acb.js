(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{124:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return l})),n.d(t,"toc",(function(){return s})),n.d(t,"default",(function(){return u}));var o=n(3),r=n(7),a=(n(0),n(212)),i={id:"docker_troubleshoot",title:"Docker Troubleshooting",sidebar_label:"Troubleshooting"},l={unversionedId:"deploy/docker_troubleshoot",id:"deploy/docker_troubleshoot",isDocsHomePage:!1,title:"Docker Troubleshooting",description:"Troubleshooting",source:"@site/docs/deploy/docker_troubleshooting.md",slug:"/deploy/docker_troubleshoot",permalink:"/netsage-pipeline/docs/next/deploy/docker_troubleshoot",editUrl:"https://github.com/netsage-project/netsage-pipeline/edit/master/website/docs/deploy/docker_troubleshooting.md",version:"current",sidebar_label:"Troubleshooting",sidebar:"Pipeline",previous:{title:"Upgrading",permalink:"/netsage-pipeline/docs/next/deploy/docker_upgrade"},next:{title:"Pipeline Replay Dataset",permalink:"/netsage-pipeline/docs/next/devel/dev_dataset"}},s=[{value:"Troubleshooting",id:"troubleshooting",children:[{value:"If you are not seeing flows after installation",id:"if-you-are-not-seeing-flows-after-installation",children:[]},{value:"If flow collection stops",id:"if-flow-collection-stops",children:[]}]}],c={toc:s};function u(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(a.b)("wrapper",Object(o.a)({},c,n,{components:t,mdxType:"MDXLayout"}),Object(a.b)("h2",{id:"troubleshooting"},"Troubleshooting"),Object(a.b)("h3",{id:"if-you-are-not-seeing-flows-after-installation"},"If you are not seeing flows after installation"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Troubleshooting checklist:")),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"Use ",Object(a.b)("inlineCode",{parentName:"li"},"docker-compose ps")," to be sure the collectors (and other containers) are running."),Object(a.b)("li",{parentName:"ul"},"Make sure you configured your routers to point to the correct address/port where the collector is running.\xa0 "),Object(a.b)("li",{parentName:"ul"},"Check iptables on your pipeline host to be sure incoming traffic from the routers is allowed."),Object(a.b)("li",{parentName:"ul"},'Check to see if nfcapd files are being written. There should be a directory for the year, month, and day in netsage-pipeline/data/input_data/netflow/ or sflow/, and files should be larger than a few hundred bytes. If the files exist but are too small, the collector is running but there are no incoming flows.  "nfdump -r filename" will show the flows in a file (you may need to install nfdump).'),Object(a.b)("li",{parentName:"ul"},"Make sure you created .env and docker-compose.override.yml files and updated the settings accordingly,  sensorName especially since that identifies the source of the data."),Object(a.b)("li",{parentName:"ul"},"Check the logs of the various containers to see if anything jumps out as being invalid.\xa0 ",Object(a.b)("inlineCode",{parentName:"li"},"docker-compose logs $service"),", where $service is logstash, importer, rabbit, etc."),Object(a.b)("li",{parentName:"ul"},"If the final rabbit queue is on an external host, check the credentials you are using and whether iptables on that host allows incoming traffic from your pipeline host.")),Object(a.b)("h3",{id:"if-flow-collection-stops"},"If flow collection stops"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Errors:")),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"See if any of the containers has died using  ",Object(a.b)("inlineCode",{parentName:"li"},"docker ps")),Object(a.b)("li",{parentName:"ul"},"Check the logs of the various containers to see if anything jumps out as being invalid.\xa0Eg, ",Object(a.b)("inlineCode",{parentName:"li"},"docker-compose logs logstash"),"."),Object(a.b)("li",{parentName:"ul"},"If logstash dies with an error about not finding ","*",".conf files, make sure conf-logstash/ and directories and files within are readable by everyone (and directories are executable by everyone). The data/ directory and subdirectories need to be readable and writable by everyone, as well.")),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Disk space:")),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"If the pipeline suddenly fails, check to see if the disk is full. If it is, first try getting rid of old docker images and containers to free up space: ",Object(a.b)("inlineCode",{parentName:"li"},"docker image prune -a")," and ",Object(a.b)("inlineCode",{parentName:"li"},"docker container prune"),"."),Object(a.b)("li",{parentName:"ul"},"Also check to see how much space the nfcapd files are consuming. You may need to add more disk space. You could also try automatically deleting nfcapd files after a fewer number of days (see Docker Advanced). ")),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Memory:")),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"If you are running a lot of data, sometimes docker may need to be allocated more memory. The most\nlikely culprit is logstash (java) which is only allocated 2GB of RAM by default. Please see the Docker Advanced guide for how to change.")))}u.isMDXComponent=!0},212:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f}));var o=n(0),r=n.n(o);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=r.a.createContext({}),u=function(e){var t=r.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=u(e.components);return r.a.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},b=r.a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,i=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=u(n),b=o,f=d["".concat(i,".").concat(b)]||d[b]||p[b]||a;return n?r.a.createElement(f,l(l({ref:t},c),{},{components:n})):r.a.createElement(f,l({ref:t},c))}));function f(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=b;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var c=2;c<a;c++)i[c]=n[c];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"}}]);