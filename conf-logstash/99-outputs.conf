#### FOR TESTING
#filter {
#  if [type] == "flow" {
#       ruby {
#          code => '
#        event.set( "@exit_time", Time.now );
#        event.set( "@processing_time", event.get("@exit_time") - event.get("@orig_injest_time") );
#      '
#       }
#   }
#}
####

output {
  if [type] == "flow" {

       #-- To send results to rabbitmq 
       # Fill in the rabbitmq host.
       # The following works if the rabbitmq username and password are in the logstash keystore as 
       # rabbitmq_output_username and rabbitmq_output_pw. You can also just type in the username and pw here, in quotes.
        rabbitmq {
            host     => "<DEST RABBITMQ HOST IP>"
            user     => "${rabbitmq_output_username}"
            password => "${rabbitmq_output_pw}"
            key           => "netsage_archive_input"
            exchange      => "netsage.direct"
            exchange_type => "direct"
            connection_timeout => 10000
            durable => true
            persistent => false
        }

       #-- For testing: To write all output to screen
       # stdout { codec => rubydebug { metadata => true } }
       #
       #-- If desired: To put results directly into local elasticsearch.
       # elasticsearch {
       #     hosts => ["127.0.0.1"]           
       #     index => "test-%{+YYYY.MM.dd}"  
       # }

  }
}
